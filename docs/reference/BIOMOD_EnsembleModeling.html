<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create and evaluate an ensemble set of models and predictions — BIOMOD_EnsembleModeling • biomod2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create and evaluate an ensemble set of models and predictions — BIOMOD_EnsembleModeling"><meta property="og:description" content="This function allows to combine a range of models built with the 
BIOMOD_Modeling function in one (or several) ensemble model. Modeling 
uncertainty can be assessed as well as variables importance, ensemble predictions can be 
evaluated against original data, and created ensemble models can be projected over new 
conditions (see Details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biomod2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2-4-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vignette_videos.html">
    <span class="fas fa-video"></span>
     
    Videos
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-stethoscope"></span>
     
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/examples_1_mainFunctions.html">Main functions</a>
    </li>
    <li>
      <a href="../articles/examples_2_secundaryFunctions.html">Secundary functions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignette_pseudoAbsences.html">Pseudo-absences</a>
    </li>
    <li>
      <a href="../articles/vignette_variability.html">Variability in results</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/news.html">
    <span class="fas fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/biomodhub/biomod2.git" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create and evaluate an ensemble set of models and predictions</h1>
    <small class="dont-index">Source: <a href="https://github.com/biomodhub/biomod2/blob/HEAD/R/BIOMOD_EnsembleModeling.R" class="external-link"><code>R/BIOMOD_EnsembleModeling.R</code></a></small>
    <div class="hidden name"><code>BIOMOD_EnsembleModeling.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to combine a range of models built with the 
<code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> function in one (or several) ensemble model. Modeling 
uncertainty can be assessed as well as variables importance, ensemble predictions can be 
evaluated against original data, and created ensemble models can be projected over new 
conditions (see Details).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BIOMOD_EnsembleModeling</span><span class="op">(</span></span>
<span>  <span class="va">bm.mod</span>,</span>
<span>  models.chosen <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  em.by <span class="op">=</span> <span class="st">"PA+run"</span>,</span>
<span>  <span class="va">em.algo</span>,</span>
<span>  metric.select <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  metric.select.thresh <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metric.select.table <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metric.select.dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metric.eval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KAPPA"</span>, <span class="st">"TSS"</span>, <span class="st">"ROC"</span><span class="op">)</span>,</span>
<span>  var.import <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  EMci.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  EMwmean.decay <span class="op">=</span> <span class="st">"proportional"</span>,</span>
<span>  nb.cpu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  do.progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">prob.mean</span>,</span>
<span>  <span class="va">prob.median</span>,</span>
<span>  <span class="va">prob.cv</span>,</span>
<span>  <span class="va">prob.ci</span>,</span>
<span>  <span class="va">committee.averaging</span>,</span>
<span>  <span class="va">prob.mean.weight</span>,</span>
<span>  <span class="va">prob.mean.weight.decay</span>,</span>
<span>  <span class="va">prob.ci.alpha</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bm.mod</dt>
<dd><p>a <code><a href="BIOMOD.models.out.html">BIOMOD.models.out</a></code> object returned by the 
<code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> function</p></dd>


<dt>models.chosen</dt>
<dd><p>a <code>vector</code> containing model names to be kept, must be either 
<code>all</code> or a sub-selection of model names that can be obtained with the 
<code><a href="getters.out.html">get_built_models</a></code> function</p></dd>


<dt>em.by</dt>
<dd><p>a <code>character</code> corresponding to the way kept models will be combined to build 
the ensemble models, must be among <code>all</code>, <code>algo</code>, <code>PA</code>, <code>PA+algo</code>, 
<code>PA+run</code></p></dd>


<dt>em.algo</dt>
<dd><p>a <code>vector</code> corresponding to the ensemble models that will be computed, 
must be among <code>'EMmean'</code>, <code>'EMmedian'</code>, <code>'EMcv'</code>, <code>'EMci'</code>, 
<code>'EMca'</code>, <code>'EMwmean'</code></p></dd>


<dt>metric.select</dt>
<dd><p>a <code>vector</code> containing evaluation metric names to be used together with 
<code>metric.select.thresh</code> to exclude single models based on their evaluation scores 
(for ensemble methods like probability weighted mean or committee averaging). Must be among  
<code>all</code> (same evaluation metrics than those of <code>bm.mod</code>), <code>user.defined</code> 
(and defined through <code>metric.select.table</code>) or <code>ROC</code>, <code>TSS</code>, <code>KAPPA</code>, 
<code>ACCURACY</code>, <code>BIAS</code>, <code>POD</code>, <code>FAR</code>, <code>POFD</code>, <code>SR</code>, <code>CSI</code>, 
<code>ETS</code>, <code>HK</code>, <code>HSS</code>, <code>OR</code>, <code>ORSS</code></p></dd>


<dt>metric.select.thresh</dt>
<dd><p>(<em>optional, default</em> <code>NULL</code>) <br> 
A <code>vector</code> of <code>numeric</code> values corresponding to the minimum scores (one for each 
<code>metric.select</code>) below which single models will be excluded from the ensemble model 
building</p></dd>


<dt>metric.select.table</dt>
<dd><p>(<em>optional, default</em> <code>NULL</code>) <br> If
<code>metric.select = 'user.defined'</code>, a <code>data.frame</code> containing
evaluation scores calculated for each single models and that will be
compared to <code>metric.select.thresh</code> values to exclude some of them
from the ensemble model building, with <code>metric.select</code> rownames, and
<code>models.chosen</code> colnames</p></dd>


<dt>metric.select.dataset</dt>
<dd><p>(<em>optional, default</em> <code>'validation'</code>
<em>if possible</em>). A character determining which dataset should be used
to filter and/or weigh the ensemble models should be among 'evaluation',
'validation' or 'calibration'.</p></dd>


<dt>metric.eval</dt>
<dd><p>a <code>vector</code> containing evaluation metric names to be used, must 
be among <code>ROC</code>, <code>TSS</code>, <code>KAPPA</code>, <code>ACCURACY</code>, <code>BIAS</code>, <code>POD</code>, 
<code>FAR</code>, <code>POFD</code>, <code>SR</code>, <code>CSI</code>, <code>ETS</code>, <code>HK</code>, <code>HSS</code>, <code>OR</code>, 
<code>ORSS</code></p></dd>


<dt>var.import</dt>
<dd><p>(<em>optional, default</em> <code>NULL</code>) <br> 
An <code>integer</code> corresponding to the number of permutations to be done for each variable to 
estimate variable importance</p></dd>


<dt>EMci.alpha</dt>
<dd><p>(<em>optional, default</em> <code>0.05</code>) <br> 
A <code>numeric</code> value corresponding to the significance level to estimate confidence interval</p></dd>


<dt>EMwmean.decay</dt>
<dd><p>(<em>optional, default</em> <code>proportional</code>) <br> A
value defining the relative importance of the weights (if <code>'EMwmean'</code>
was given to argument <code>em.algo</code>). A high value will strongly
discriminate <em>good</em> models from the <em>bad</em> ones (see Details),
while <code>proportional</code> will attribute weights proportionally to the
models evaluation scores</p></dd>


<dt>nb.cpu</dt>
<dd><p>(<em>optional, default</em> <code>1</code>) <br> 
An <code>integer</code> value corresponding to the number of computing resources to be used to 
parallelize the single models computation</p></dd>


<dt>seed.val</dt>
<dd><p>(<em>optional, default</em> <code>NULL</code>) <br> 
An <code>integer</code> value corresponding to the new seed value to be set</p></dd>


<dt>do.progress</dt>
<dd><p>(<em>optional, default</em> <code>TRUE</code>) <br> 
A <code>logical</code> value defining whether the progress bar is to be rendered or not</p></dd>


<dt>prob.mean</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code> instead) <br>
A <code>logical</code> value defining whether to compute the mean probabilities
across predictions or not</p></dd>


<dt>prob.median</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code> instead)
<br> A <code>logical</code> value defining whether to compute the median
probabilities across predictions or not</p></dd>


<dt>prob.cv</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code> instead) <br> A
<code>logical</code> value defining whether to compute the coefficient of
variation across predictions or not</p></dd>


<dt>prob.ci</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code> instead) <br> A
<code>logical</code> value defining whether to compute the confidence interval
around the <code>prob.mean</code> ensemble model or not</p></dd>


<dt>committee.averaging</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code>
instead) <br> A <code>logical</code> value defining whether to compute the
committee averaging across predictions or not</p></dd>


<dt>prob.mean.weight</dt>
<dd><p>(<em>deprecated</em>, please use <code>em.algo</code>
instead) <br> A <code>logical</code> value defining whether to compute the
weighted sum of probabilities across predictions or not</p></dd>


<dt>prob.mean.weight.decay</dt>
<dd><p>(<em>deprecated</em>, please use
<code>EMwmean.decay</code> instead)  <br> old argument name for
<code>EMwmean.decay</code></p></dd>


<dt>prob.ci.alpha</dt>
<dd><p>(<em>deprecated</em>, please use <code>EMci.alpha</code>
instead) <br> old argument name for <code>EMci.alpha</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>BIOMOD.ensemble.models.out</code> object containing models outputs, or links to saved 
outputs. <br> Models outputs are stored out of <span style="R">R</span> (for memory storage reasons) in 2 different 
folders created in the current working directory :</p><ol><li><p>a <em>models</em> folder, named after the <code>resp.name</code> argument of 
  <code><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></code>, and containing all ensemble models</p></li>
<li><p>a <em>hidden</em> folder, named <code>.BIOMOD_DATA</code>, and containing outputs related 
  files (original dataset, calibration lines, pseudo-absences selected, predictions, 
  variables importance, evaluation values...), that can be retrieved with 
  <a href="https://biomodhub.github.io/biomod2/reference/getters.out.html" class="external-link"><code>get_[...]</code></a> or <code><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></code> functions, and used by other 
  <span class="pkg">biomod2</span> functions, like <code><a href="BIOMOD_EnsembleForecasting.html">BIOMOD_EnsembleForecasting</a></code></p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    
<dl><dt>Models sub-selection (<code>models.chosen</code>)</dt>
<dd><p>Applying <code><a href="getters.out.html">get_built_models</a></code> 
  function to the <code>bm.mod</code> object gives the names of the single models created 
  with the <code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> function. The <code>models.chosen</code> argument can take 
  either a sub-selection of these single model names, or the <code>all</code> default value, to 
  decide which single models will be used for the ensemble model building.</p></dd>


  <dt>Models assembly rules (<code>em.by</code>)</dt>
<dd><p>Single models built with the 
  <code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> function can be combined in 5 different ways to obtain 
  ensemble models :</p><ul><li><p><code>PA+run</code> : each combination of pseudo-absence and repetition 
    datasets is done, <em>merging</em> algorithms together</p></li>
<li><p><code>PA+algo</code> : each combination of pseudo-absence and algorithm datasets 
    is done, <em>merging</em> repetitions together</p></li>
<li><p><code>PA</code> : pseudo-absence datasets are considered individually, 
    <em>merging</em> algorithms and repetitions together</p></li>
<li><p><code>algo</code> : algorithm datasets are considered individually, <em>merging</em> 
    pseudo-absence and repetitions together</p></li>
<li><p><code>all</code> : all models are combined into one</p></li>
</ul><p>Hence, depending on the chosen method, the number of ensemble models built will vary. <br><em>Be aware that if no evaluation data was given to the 
  <code><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></code> function, some ensemble model evaluations may be biased 
  due to difference in data used for single model evaluations.</em>
  <b>Be aware that all of these combinations are allowed, but some may not make sense 
  depending mainly on how pseudo-absence datasets have been built and whether all of them 
  have been used for all single models or not (see <code>PA.nb.absences</code> and <code>models.pa</code> 
  parameters in <code><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></code> and <code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> functions 
  respectively).</b></p></dd>


  <dt>Evaluation metrics</dt>
<dd><p></p><ul><li><p><b><code>metric.select</code></b> : the selected metrics must be chosen among the ones used
    within the <code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code> function to build the <code>model.output</code> object,
    unless <code>metric.select = 'user.defined'</code> and therefore values will be provided through
    the <code>metric.select.table</code> parameter. <br> In the case of the selection of several
    metrics, they will be used at different steps of the ensemble modeling function :
    </p><ol><li><p>remove <em>low quality</em> single models, having a score lower than
      <code>metric.select.thresh</code></p></li>
<li><p>perform the binary transformation needed if <code>'EMca'</code>
      was given to argument <code>em.algo</code></p></li>
<li><p>weight models if <code>'EMwmean'</code> was given to argument <code>em.algo</code></p></li>
</ol></li>
<li><p><b><code>metric.select.thresh</code></b> : as many values as evaluation metrics
    selected with the <code>metric.select</code> parameter, and defining the corresponding quality
    thresholds below which the single models will be excluded from the ensemble model
    building.</p></li>
<li><p><b><code>metric.select.table</code></b> : a <code>data.frame</code> must be given if
    <code>metric.select = 'user.defined'</code> to allow the use of evaluation metrics other than
    those calculated within <span class="pkg">biomod2</span>. The <code>data.frame</code> must contain as many columns
    as <code>models.chosen</code> with matching names, and as many rows as evaluation metrics to be
    used. The number of rows must match the length of the <code>metric.select.thresh</code>
    parameter. The values contained in the <code>data.frame</code> will be compared to those defined
    in <code>metric.select.thresh</code> to remove <em>low quality</em> single models from
    the ensemble model building.</p></li>
<li><p><b><code>metric.select.dataset</code></b> : a <code>character</code> determining the dataset
    which evaluation metric should be used to filter and/or weigh the
    ensemble models. Should be among <code>evaluation</code>, <code>validation</code> or
    <code>calibration</code>. By default <code>BIOMOD_EnsembleModeling</code> will use
    the validation dataset unless no validation is available in which case
    calibration dataset are used.</p></li>
<li><p><b><code>metric.eval</code></b> : the selected metrics will be used to validate/evaluate
    the ensemble models built</p></li>
</ul><p></p></dd>


  <dt>Ensemble-models algorithms</dt>
<dd><p>The set of models to be calibrated on the data. <br> 
  6 modeling techniques are currently available :</p><ul><li><p><b><code>EMmean</code></b> : Mean of probabilities over the selected models. Old name: <code>prob.mean</code></p></li>
<li><p><b><code>EMmedian</code></b> : Median of probabilities over the selected models <br> 
    The median is less sensitive to outliers than the mean, however it requires more 
    computation time and memory as it loads all predictions (on the contrary to the mean or 
    the weighted mean). Old name: <code>prob.median</code></p></li>
<li><p><b><code>EMcv</code></b> : Coefficient of variation (sd / mean) of probabilities 
    over the selected models <br> 
    This model is not scaled. It will be evaluated like all other ensemble models although its 
    interpretation will be obviously different. CV is a measure of uncertainty rather a 
    measure of probability of occurrence. If the CV gets a high evaluation score, it means 
    that the uncertainty is high where the species is observed (which might not be a good 
    feature of the model). <em>The lower is the score, the better are the models.</em> 
    CV is a nice complement to the mean probability.  Old name: <code>prob.cv</code></p></li>
<li><p><b><code>EMci</code></b> &amp; <b><code>EMci.alpha</code></b> : Confidence interval around 
    the mean of probabilities of the selected models <br> 
    It is also a nice complement to the mean probability. It creates 2 ensemble models : 
    </p><ul><li><p><em>LOWER</em> : there is less than <code>100 * EMci.alpha / 2</code> % of chance to 
      get probabilities lower than the given ones</p></li>
<li><p><em>UPPER</em> : there is less than <code>100 * EMci.alpha / 2</code> % of chance to 
      get probabilities upper than the given ones</p></li>
</ul>
    These intervals are calculated with the following function :
    $$I_c = [ \bar{x} -  \frac{t_\alpha sd }{ \sqrt{n} }; 
    \bar{x} +  \frac{t_\alpha sd }{ \sqrt{n} }]$$
    <br>
    Old parameter name: <code>prob.ci</code> &amp; <code>prob.ci.alpha</code></li>
<li><p><b><code>EMca</code></b> : Probabilities from the selected models are 
    first transformed into binary data according to the thresholds defined when building the 
    <code>model.output</code> object with the <code>BIOMOD_Modeling</code> function, maximizing the 
    evaluation metric score over the testing dataset. The committee averaging score is 
    obtained by taking the average of these binary predictions. It is built on the analogy 
    of a simple vote :
    </p><ul><li><p>each single model votes for the species being either present (<code>1</code>) or absent 
      (<code>0</code>)</p></li>
<li><p>the sum of <code>1</code> is then divided by the number of single models <em>voting</em></p></li>
</ul>
    The interesting feature of this measure is that it gives both a prediction and a measure 
    of uncertainty. When the prediction is close to <code>0</code> or <code>1</code>, it means that all 
    models agree to predict <code>0</code> or <code>1</code> respectively. When the prediction is around 
    <code>0.5</code>, it means that half the models predict <code>1</code> and the other half <code>0</code>. 
    <br> Old parameter name: <code>committee.averaging</code></li>
<li><p><b><code>EMwmean</code></b> &amp; <b><code>EMwmean.decay</code></b> : 
    Probabilities from the selected models are weighted according to their evaluation scores 
    obtained when building the <code>model.output</code> object with the <code>BIOMOD_Modeling</code> 
    function (<em>better a model is, more importance it has in the ensemble</em>) and summed. <br>
    Old parameter name: <code>prob.mean.weight</code> &amp; <code>prob.mean.weight.decay</code></p></li>
</ul><p>The <code>EMwmean.decay</code> is the ratio between a weight and the next or previous one. 
The formula is : <code>W = W(-1) * EMwmean.decay</code>. <em>For example, with the value 
of <code>1.6</code> and <code>4</code> weights wanted, the relative importance of the weights will be 
<code>1/1.6/2.56(=1.6*1.6)/4.096(=2.56*1.6)</code> from the weakest to the strongest, and gives 
<code>0.11/0.17/0.275/0.445</code> considering that the sum of the weights is equal to one. The 
lower the <code>EMwmean.decay</code>, the smoother the differences between the weights 
enhancing a weak discrimination between models.</em></p>
<p>If <code>EMwmean.decay = 'proportional'</code>, the weights are assigned to each model 
proportionally to their evaluation scores. The discrimination is fairer than using the 
<em>decay</em> method where close scores can have strongly diverging weights, while the 
proportional method would assign them similar weights.</p>
<p>It is also possible to define the <code>EMwmean.decay</code> parameter as a function that 
will be applied to single models scores and transform them into weights. <em>For example, 
if <code>EMwmean.decay = function(x) {x^2}</code>, the squared of evaluation score of each 
model will be used to weight the models predictions.</em></p></dd>


</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></code>, <code><a href="BIOMOD_ModelingOptions.html">BIOMOD_ModelingOptions</a></code>, 
<code><a href="bm_CrossValidation.html">bm_CrossValidation</a></code>, <code><a href="bm_VariablesImportance.html">bm_VariablesImportance</a></code>, 
<code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code>, <code><a href="BIOMOD_EnsembleForecasting.html">BIOMOD_EnsembleForecasting</a></code>,
<code><a href="bm_PlotEvalMean.html">bm_PlotEvalMean</a></code>, <code><a href="bm_PlotEvalBoxplot.html">bm_PlotEvalBoxplot</a></code>, 
<code><a href="bm_PlotVarImpBoxplot.html">bm_PlotVarImpBoxplot</a></code>, <code><a href="bm_PlotResponseCurves.html">bm_PlotResponseCurves</a></code></p>
<p>Other Main functions: 
<code><a href="BIOMOD_EnsembleForecasting.html">BIOMOD_EnsembleForecasting</a>()</code>,
<code><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a>()</code>,
<code><a href="BIOMOD_LoadModels.html">BIOMOD_LoadModels</a>()</code>,
<code><a href="BIOMOD_ModelingOptions.html">BIOMOD_ModelingOptions</a>()</code>,
<code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a>()</code>,
<code><a href="BIOMOD_PresenceOnly.html">BIOMOD_PresenceOnly</a>()</code>,
<code><a href="BIOMOD_Projection.html">BIOMOD_Projection</a>()</code>,
<code><a href="BIOMOD_RangeSize.html">BIOMOD_RangeSize</a>()</code>,
<code><a href="BIOMOD_Tuning.html">BIOMOD_Tuning</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wilfried Thuiller, Damien Georges, Robin Engler</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co"># Load species occurrences (6 species available)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DataSpecies</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DataSpecies</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select the name of the studied species</span></span>
<span><span class="va">myRespName</span> <span class="op">&lt;-</span> <span class="st">'GuloGulo'</span></span>
<span></span>
<span><span class="co"># Get corresponding presence/absence data</span></span>
<span><span class="va">myResp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">DataSpecies</span><span class="op">[</span>, <span class="va">myRespName</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get corresponding XY coordinates</span></span>
<span><span class="va">myRespXY</span> <span class="op">&lt;-</span> <span class="va">DataSpecies</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X_WGS84'</span>, <span class="st">'Y_WGS84'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Load environmental variables extracted from BIOCLIM (bio_3, bio_4, bio_7, bio_11 &amp; bio_12)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioclim_current</span><span class="op">)</span></span>
<span><span class="va">myExpl</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">bioclim_current</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># \dontshow{</span></span>
<span><span class="va">myExtent</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">45</span>,<span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">myExpl</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">myExpl</span>, <span class="va">myExtent</span><span class="op">)</span></span>
<span><span class="co"># }</span></span>
<span></span>
<span><span class="co">## ----------------------------------------------------------------------- #</span></span>
<span><span class="va">file.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">myRespName</span>, <span class="st">"/"</span>, <span class="va">myRespName</span>, <span class="st">".AllModels.models.out"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file.out</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">myBiomodModelOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file.out</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Format Data with true absences</span></span>
<span>  <span class="va">myBiomodData</span> <span class="op">&lt;-</span> <span class="fu"><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></span><span class="op">(</span>resp.var <span class="op">=</span> <span class="va">myResp</span>,</span>
<span>                                       expl.var <span class="op">=</span> <span class="va">myExpl</span>,</span>
<span>                                       resp.xy <span class="op">=</span> <span class="va">myRespXY</span>,</span>
<span>                                       resp.name <span class="op">=</span> <span class="va">myRespName</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create default modeling options</span></span>
<span>  <span class="va">myBiomodOptions</span> <span class="op">&lt;-</span> <span class="fu"><a href="BIOMOD_ModelingOptions.html">BIOMOD_ModelingOptions</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Model single models</span></span>
<span>  <span class="va">myBiomodModelOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></span><span class="op">(</span>bm.format <span class="op">=</span> <span class="va">myBiomodData</span>,</span>
<span>                                      modeling.id <span class="op">=</span> <span class="st">'AllModels'</span>,</span>
<span>                                      models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'RF'</span>, <span class="st">'GLM'</span><span class="op">)</span>,</span>
<span>                                      bm.options <span class="op">=</span> <span class="va">myBiomodOptions</span>,</span>
<span>                                      CV.strategy <span class="op">=</span> <span class="st">'random'</span>,</span>
<span>                                      CV.nb.rep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                      CV.perc <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                                      metric.eval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span>,<span class="st">'ROC'</span><span class="op">)</span>,</span>
<span>                                      var.import <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                      seed.val <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## ----------------------------------------------------------------------- #</span></span>
<span><span class="co"># Model ensemble models</span></span>
<span><span class="va">myBiomodEM</span> <span class="op">&lt;-</span> <span class="fu">BIOMOD_EnsembleModeling</span><span class="op">(</span>bm.mod <span class="op">=</span> <span class="va">myBiomodModelOut</span>,</span>
<span>                                      models.chosen <span class="op">=</span> <span class="st">'all'</span>,</span>
<span>                                      em.by <span class="op">=</span> <span class="st">'all'</span>,</span>
<span>                                      em.algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'EMmean'</span>, <span class="st">'EMca'</span><span class="op">)</span>,</span>
<span>                                      metric.select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span><span class="op">)</span>,</span>
<span>                                      metric.select.thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>,</span>
<span>                                      metric.eval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span>, <span class="st">'ROC'</span><span class="op">)</span>,</span>
<span>                                      var.import <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                      seed.val <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">myBiomodEM</span></span>
<span></span>
<span><span class="co"># Get evaluation scores &amp; variables importance</span></span>
<span><span class="fu"><a href="getters.out.html">get_evaluations</a></span><span class="op">(</span><span class="va">myBiomodEM</span><span class="op">)</span></span>
<span><span class="fu"><a href="getters.out.html">get_variables_importance</a></span><span class="op">(</span><span class="va">myBiomodEM</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Represent evaluation scores</span></span>
<span><span class="fu"><a href="bm_PlotEvalMean.html">bm_PlotEvalMean</a></span><span class="op">(</span>bm.out <span class="op">=</span> <span class="va">myBiomodEM</span>, dataset <span class="op">=</span> <span class="st">'calibration'</span><span class="op">)</span></span>
<span><span class="fu"><a href="bm_PlotEvalBoxplot.html">bm_PlotEvalBoxplot</a></span><span class="op">(</span>bm.out <span class="op">=</span> <span class="va">myBiomodEM</span>, group.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'algo'</span>, <span class="st">'algo'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # Represent variables importance</span></span>
<span><span class="co"># bm_PlotVarImpBoxplot(bm.out = myBiomodEM, group.by = c('expl.var', 'algo', 'algo'))</span></span>
<span><span class="co"># bm_PlotVarImpBoxplot(bm.out = myBiomodEM, group.by = c('expl.var', 'algo', 'merged.by.PA'))</span></span>
<span><span class="co"># bm_PlotVarImpBoxplot(bm.out = myBiomodEM, group.by = c('algo', 'expl.var', 'merged.by.PA'))</span></span>
<span></span>
<span><span class="co"># # Represent response curves</span></span>
<span><span class="co"># bm_PlotResponseCurves(bm.out = myBiomodEM, </span></span>
<span><span class="co">#                       models.chosen = get_built_models(myBiomodEM),</span></span>
<span><span class="co">#                       fixed.var = 'median')</span></span>
<span><span class="co"># bm_PlotResponseCurves(bm.out = myBiomodEM, </span></span>
<span><span class="co">#                       models.chosen = get_built_models(myBiomodEM),</span></span>
<span><span class="co">#                       fixed.var = 'min')</span></span>
<span><span class="co"># bm_PlotResponseCurves(bm.out = myBiomodEM, </span></span>
<span><span class="co">#                       models.chosen = get_built_models(myBiomodEM, algo = 'EMmean'),</span></span>
<span><span class="co">#                       fixed.var = 'median',</span></span>
<span><span class="co">#                       do.bivariate = TRUE)</span></span>
<span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://www.will.chez-alice.fr/" class="external-link">Wilfried Thuiller</a>, Damien Georges, <a href="https://mayagueguen.github.io" class="external-link">Maya Gueguen</a>, Robin Engler, Frank Breiner, Bruno Lafourcade, Remi Patin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

